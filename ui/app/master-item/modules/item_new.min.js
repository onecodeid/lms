import*as api from"./api_item.js";import{one_token}from"../../assets/js/global.js";export default{namespaced:!0,state:{edit:!1,search_status:0,search_error_message:"",search:"",selected_item:{},dialog_new:!1,item_name:"",item_address:"",item_weight:0,units:[],selected_unit:{},total_unit:0},mutations:{set_common(state,v){let name=v[0],val=v[1];"string"==typeof val?eval(`state.${name} = "${val}"`):eval(`state.${name} = ${val}`)},update_search_error_message(state,msg){state.search_error_message=msg},update_search(state,search){state.search=search},set_selected_item(state,val){state.selected_item=val},update_search_status(state,val){state.search_status=val},set_dialog_new(state,v){state.dialog_new=v},set_units(state,v){state.units=v},set_selected_unit(state,v){state.selected_unit=v}},actions:{async save(context){try{let prm={token:one_token(),item_name:context.state.item_name,item_code:context.state.item_code},resp=await api.save(prm);console.log(resp),"OK"!=resp.status?(context.commit("update_search_status",3),context.commit("update_search_error_message",resp.message)):(context.commit("set_common",["search_status",2]),context.commit("update_search_error_message",""),context.commit("set_common",["dialog_new",!1]),context.dispatch("item/search",[],{root:!0}))}catch(e){context.commit("set_common",["search_city_status",3]),context.commit("update_search_error_message",e.message),console.log(e)}},async search_unit(context,prm){context.commit("update_search_status",1);try{prm.token=one_token();let resp=await api.search_unit(prm);if("OK"!=resp.status)context.commit("update_search_status",3),context.commit("update_search_error_message",resp.message);else{context.commit("update_search_status",2),context.commit("update_search_error_message","");let data={records:resp.data.records,total:resp.data.total};context.commit("set_units",data.records),context.commit("set_common",["total_unit",data.total])}}catch(e){context.commit("update_search_status",3),context.commit("update_search_error_message",e.message),console.log(e)}}}};